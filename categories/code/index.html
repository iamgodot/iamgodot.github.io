<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Code | Godot's Blog</title><meta name=keywords content><meta name=description content><meta name=author content><link rel=canonical href=https://iamgodot.com/categories/code/><link crossorigin=anonymous href=/assets/css/stylesheet.min.7cb1aaa4414c482febc7034a427761d087a2cf358f1be8f7beba5afc947b57d0.css integrity="sha256-fLGqpEFMSC/rxwNKQndh0IeizzWPG+j3vrpa/JR7V9A=" rel="preload stylesheet" as=style><link rel=icon href=https://iamgodot.com/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://iamgodot.com/icons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://iamgodot.com/icons/favicon-32x32.png><link rel=apple-touch-icon href=https://iamgodot.com/icons/apple-touch-icon.png><link rel=mask-icon href=https://iamgodot.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://iamgodot.com/categories/code/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Source+Code+Pro:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Source+Code+Pro:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=preconnect href=https://plausible.iamgodot.com><script defer data-domain=iamgodot.com src=https://plausible.iamgodot.com/js/plausible.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script><script></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-157042624-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Code"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://iamgodot.com/categories/code/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Code"><meta name=twitter:description content></head><body class="list dark" id=top><header class=header><nav class=nav><div class=logo><a href=https://iamgodot.com accesskey=h title="Godot's Blog (Alt + H)">Godot's Blog</a>
<span class=logo-switches></span></div><ul id=menu></ul></nav></header><main class=main><header class=page-header><h1>Code</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>My Neovim Revamp</h2></header><section class=entry-content><p>Yeah, I did it again, but for a good reason.
I have been using VSCode for while, which is great with plugins like GitLens and Docker. Besides, it’s really handy to debug code, view all kinds of files and draw various diagrams such as UML. I thought I’d wave my hands to Neovim, however, I found I still need it, a lot.
Not trying to nitpick, but I have to switch between keyboard and mouse from time to time with VSCode, which sometimes can really interrupt my train of thoughts....</p></section><footer class=entry-footer><span title='2023-04-05 20:31:52 +0800 +0800'>04-05</span>&nbsp;·&nbsp;5 min</footer><a class=entry-link aria-label="post link to My Neovim Revamp" href=https://iamgodot.com/posts/my-neovim-revamp/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Python 中的异常</h2></header><section class=entry-content><p>在 Python 中，EAFP 的风格很受青睐，这种写法能让代码更加简洁，还可以避免一些重复判断和多线程竞争的问题。为此，了解并熟练使用异常是很重要的。
异常类 首先来看一下 Python 内置的异常类（有省略）：
BaseException +-- SystemExit +-- KeyboardInterrupt +-- GeneratorExit +-- Exception +-- StopIteration +-- StopAsyncIteration +-- ArithmeticError +-- AssertionError +-- AttributeError +-- BufferError +-- EOFError +-- ImportError +-- LookupError +-- MemoryError +-- NameError +-- OSError +-- ReferenceError +-- RuntimeError +-- SyntaxError +-- SystemError +-- TypeError +-- ValueError +-- Warning BaseException 是所有异常的老祖宗，但很少会用到，通常我们只需要 Exception，比如自定义一个错误类型：
# 命名习惯一般以 Error 结尾 class CustomError(Exception): def __init__(self, message, status): # 这里最好把参数都放进去，之后会统一存在 e....</p></section><footer class=entry-footer><span title='2022-09-15 18:02:18 +0800 +0800'>09-15</span>&nbsp;·&nbsp;3 min</footer><a class=entry-link aria-label="post link to Python 中的异常" href=https://iamgodot.com/posts/exception-in-python/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Python Import 源码阅读</h2></header><section class=entry-content><p>浅析一下 Python 中的 Import 机制。代码版本：3.11.0 - 4dd8219。
Module & Package Import 的对象就是各种各样的模块，即 Module。如何定义呢？官方文档这样描述：
A module is a file containing Python definitions and statements.
实际上，Module 可以是 Builtin，也可以是 C extension，但最常见的存在形式还是 *.py 文件。
一个 Module 同时也可能是 Package，此时它从文件升级为目录，就可以拥有 Submodule 了。Package 分为两种：
Regular package：这类 Package 必须包含一个 __init__.py 文件，代表了这个 Module(Package) 本身。 Namespace package：如果不存在 __init__.py，Python 会将其创建为此类 Package。Namespace package 的特殊之处在于同名的 Package 可以出现在多个目录下，而 Import 完成之后又可以统一使用。 不管是哪一种 Package，都会有 __path__ 属性，指向目录的路径。属性值是个列表，这对于 Namespace package 尤为重要。除此之外，一个 Module 还有：
__name__：模块名称。 __file__：文件位置。 __package__：主要是为了在 Relative import 时计算起点位置。 如果是 Package 则设置为 __name__。 如果非 Package 则设置为 Parent package 的名称（Top-level 的 Module 应为空字符串）。 如果以脚本执行，那么取值为 None。 How to Import 一般情况下 Import 都是通过 import 关键字完成的，可分为两大类：...</p></section><footer class=entry-footer><span title='2022-09-10 18:20:40 +0800 +0800'>09-10</span>&nbsp;·&nbsp;6 min</footer><a class=entry-link aria-label="post link to Python Import 源码阅读" href=https://iamgodot.com/posts/source-code-of-python-import/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Sum of Total Strength of Wizards</h2></header><section class=entry-content><p>前两天做了一道算法题，虽然没能成功解决，但是是一道很有意思的题目。
抛开题面的包装不谈，核心内容就是给定一个数组，计算它的所有子数组的最小值与加和的乘积的总和。
（这里要注意子数组的定义，一定是连续的，如果不连续的话叫做子序列。）
比如对于 [1, 2, 3] 来说，一共有六种情况：
[1]: 1 * 1 = 1 [2]: 2 * 2 = 4 [3]: 3 * 3 = 9 [1, 2]: 1 * (1 + 2) = 3 [2, 3]: 2 * (2 + 3) = 10 [1, 2, 3]: 1 * (1 + 2 + 3) = 6 最后答案为 1 + 4 + 9 + 3 + 10 + 6 = 33。...</p></section><footer class=entry-footer><span title='2022-07-26 10:41:55 +0800 +0800'>07-26</span>&nbsp;·&nbsp;3 min</footer><a class=entry-link aria-label="post link to Sum of Total Strength of Wizards" href=https://iamgodot.com/posts/sum-of-total-strength-of-wizards/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>关于 CORS</h2></header><section class=entry-content><p>说起 CORS，就不得不先提到 SOP(Same-origin policy)：浏览器打开的网页只可以对该网页的同源网站发起请求。注意，受约束的主要是脚本代码，不包括图片或者 CSS 等资源（字体文件是个例外）。同源的定义包括三部分，即协议、域名和端口都要保持一致。
为了缓解 SOP 带来的严格限制，有几种主流的解决方案可以选择：
CORS JSONP：利用 &lt;script> 标签来请求非同源地址的 JSON 响应，同时配合一个预先定义的回调函数来处理响应数据。 WebSocket：WS 连接并不受同源策略的约束，但是在建立连接时服务端也需要判断 headers 中的 Origin 是否可以接受。 其中 CORS 应该是最实用的一种，相比 JSONP 只支持 GET 请求，前者扩展了各种 HTTP 方法的跨域调用。
CORS(Cross-origin resource sharing)，是一种跨域共享资源的机制，它利用特定的 Headers 来保证跨域请求的安全性，这些请求分为两类：简单请求和非简单请求。
简单请求，包括 GET、HEAD 和 POST，这里 POST 的 Content-Type 仅限于下面三种：
application/x-www-form-urlencoded
multipart/form-data
text/plain
对于这些请求来说，只需要保证 Access-Control-Allow-Origin 中匹配了当前网页的域名即可，如果是 * 的话表明所有的域名都是允许的。
非简单请求，比如 Content-Type 为 application/json 的 POST，会增加一次额外的 Preflight 请求，即先发送 OPTIONS 请求给服务器，然后通过响应中的一系列 Headers 决定是否可以进行真正的请求。这些 Headers 包括：
Access-Control-Allow-Methods：服务器允许的跨域方法，比如 POST。 Access-Control-Allow-Headers：服务器允许的跨域头部，比如 Content-Type。 Access-Control-Max-Age：Preflight 请求结果的缓存时间，默认为 5s。 另外，如果想在 Chrome 中查看 Preflight 请求的话，打开 Network 标签，点击 Other filter 就可以看到了。...</p></section><footer class=entry-footer><span title='2022-05-17 23:42:11 +0800 +0800'>05-17</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to 关于 CORS" href=https://iamgodot.com/posts/about-cors/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://iamgodot.com/categories/code/page/2/>Next Page »</a></nav></footer></main><footer class=footer><span>&copy; 2020-2023 <a href=https://iamgodot.com>Godot's Blog</a></span>
<span>| <a href=http://beian.miit.gov.cn/ target=_blank>京ICP备20005558号-2</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>