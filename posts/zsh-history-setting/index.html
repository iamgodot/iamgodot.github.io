<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>History Setting in Zsh | Godot's Blog</title>
<meta name=keywords content><meta name=description content="If you&rsquo;re using zsh, you&rsquo;ve probably bundled it with oh-my-zsh, which does a lot of zsh configs underneath. In my case, it has worked well for a pretty long time until I switched to starship, yet it took me a while to figure out how to properly set up history in zsh without it.
First of all, if you&rsquo;re using MacOS, you&rsquo;ll notice things still work fine, this is because there is a system-wide history setting in /etc/zshrc."><meta name=author content><link rel=canonical href=https://iamgodot.com/posts/zsh-history-setting/><link crossorigin=anonymous href=/assets/css/stylesheet.6cc4959a90f82fcf5ecbaf25ad6d8d2e7e9acd928a2f203bdd506cce60c53564.css integrity="sha256-bMSVmpD4L89ey68lrW2NLn6azZKKLyA73VBszmDFNWQ=" rel="preload stylesheet" as=style><link rel=icon href=https://iamgodot.com/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://iamgodot.com/icons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://iamgodot.com/icons/favicon-32x32.png><link rel=apple-touch-icon href=https://iamgodot.com/icons/apple-touch-icon.png><link rel=mask-icon href=https://iamgodot.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://iamgodot.com/posts/zsh-history-setting/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css><script defer src=https://us.umami.is/script.js data-website-id=9000d82d-f063-4632-aa6a-a33e85bf4234></script><meta property="og:title" content="History Setting in Zsh"><meta property="og:description" content="If you&rsquo;re using zsh, you&rsquo;ve probably bundled it with oh-my-zsh, which does a lot of zsh configs underneath. In my case, it has worked well for a pretty long time until I switched to starship, yet it took me a while to figure out how to properly set up history in zsh without it.
First of all, if you&rsquo;re using MacOS, you&rsquo;ll notice things still work fine, this is because there is a system-wide history setting in /etc/zshrc."><meta property="og:type" content="article"><meta property="og:url" content="https://iamgodot.com/posts/zsh-history-setting/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-29T22:05:55-07:00"><meta property="article:modified_time" content="2024-06-29T22:05:55-07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="History Setting in Zsh"><meta name=twitter:description content="If you&rsquo;re using zsh, you&rsquo;ve probably bundled it with oh-my-zsh, which does a lot of zsh configs underneath. In my case, it has worked well for a pretty long time until I switched to starship, yet it took me a while to figure out how to properly set up history in zsh without it.
First of all, if you&rsquo;re using MacOS, you&rsquo;ll notice things still work fine, this is because there is a system-wide history setting in /etc/zshrc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://iamgodot.com/posts/"},{"@type":"ListItem","position":2,"name":"History Setting in Zsh","item":"https://iamgodot.com/posts/zsh-history-setting/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"History Setting in Zsh","name":"History Setting in Zsh","description":"If you\u0026rsquo;re using zsh, you\u0026rsquo;ve probably bundled it with oh-my-zsh, which does a lot of zsh configs underneath. In my case, it has worked well for a pretty long time until I switched to starship, yet it took me a while to figure out how to properly set up history in zsh without it.\nFirst of all, if you\u0026rsquo;re using MacOS, you\u0026rsquo;ll notice things still work fine, this is because there is a system-wide history setting in /etc/zshrc.","keywords":[],"articleBody":"If you’re using zsh, you’ve probably bundled it with oh-my-zsh, which does a lot of zsh configs underneath. In my case, it has worked well for a pretty long time until I switched to starship, yet it took me a while to figure out how to properly set up history in zsh without it.\nFirst of all, if you’re using MacOS, you’ll notice things still work fine, this is because there is a system-wide history setting in /etc/zshrc. But if you’re on Linux, you’ll need to set it up yourself.\nWithout any configs, command history will only be available in the current session, and will be lost once you close it. Besides, different sessions’ history won’t be shared. To get a better experience, there’re 3 options:\nsetopt appendhistory: session history will be saved by appending to the end of the history file. But this only happens when you close the session, which is not very handy. setopt inc_append_history: what’s better about this is an executed command gets immediately written to the history file, thus becomes available in other sessions. However, the current session won’t be able to access history from other sessions. setopt share_history: besides history writting, this one also reads history for updates, so it’s probably the best option in my mind. One thing to remind is that for history reading you need to fire history command, so actions like CTRL-R from Fzf just won’t work.\nIn addition to the above options, you’ll also want to add a few more configs:\nHISTFILE: path of the history file, which is usually ~/.zsh_history. SAVEHIST: maximum number of history lines to save in the file, this could be a thousand or a billion, depending on your preference. HISTSIZE: maximum number of history lines to keep in memory, which is usually the same as SAVEHIST. This could also be larger than SAVEHIST but not the other way around, because you simply can’t save more than you have. There’s also setopt extendedhistory and HISTTIMEFORMAT to add timestamps for those records, but I don’t find them very useful so I won’t cover them here. You may try history -E to take a look.\nI’ve always been aware of this, but it reminded me again how little I know about the shell I’m using. On the other hand, it actually makes sense that we don’t need to bother with learning something until we do.\nReferences Better zsh history ","wordCount":"402","inLanguage":"en","datePublished":"2024-06-29T22:05:55-07:00","dateModified":"2024-06-29T22:05:55-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://iamgodot.com/posts/zsh-history-setting/"},"publisher":{"@type":"Organization","name":"Godot's Blog","logo":{"@type":"ImageObject","url":"https://iamgodot.com/icons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://iamgodot.com/ accesskey=h title="Godot's Blog (Alt + H)">Godot's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">History Setting in Zsh</h1><div class=post-meta><span title='2024-06-29 22:05:55 -0700 -0700'>06-29</span>&nbsp;·&nbsp;2 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><p>If you&rsquo;re using zsh, you&rsquo;ve probably bundled it with oh-my-zsh, which does a lot of zsh configs underneath. In my case, it has worked well for a pretty long time until I switched to starship, yet it took me a while to figure out how to properly set up history in zsh without it.</p><p>First of all, if you&rsquo;re using MacOS, you&rsquo;ll notice things still work fine, this is because there is a system-wide history setting in <code>/etc/zshrc</code>. But if you&rsquo;re on Linux, you&rsquo;ll need to set it up yourself.</p><p>Without any configs, command history will only be available in the current session, and will be lost once you close it. Besides, different sessions&rsquo; history won&rsquo;t be shared. To get a better experience, there&rsquo;re 3 options:</p><ol><li><code>setopt appendhistory</code>: session history will be saved by appending to the end of the history file. But this only happens when you close the session, which is not very handy.</li><li><code>setopt inc_append_history</code>: what&rsquo;s better about this is an executed command gets immediately written to the history file, thus becomes available in other sessions. However, the current session won&rsquo;t be able to access history from other sessions.</li><li><code>setopt share_history</code>: besides history writting, this one also reads history for updates, so it&rsquo;s probably the best option in my mind.</li></ol><p>One thing to remind is that for history reading you need to fire <code>history</code> command, so actions like <code>CTRL-R</code> from Fzf just won&rsquo;t work.</p><p>In addition to the above options, you&rsquo;ll also want to add a few more configs:</p><ul><li><code>HISTFILE</code>: path of the history file, which is usually <code>~/.zsh_history</code>.</li><li><code>SAVEHIST</code>: maximum number of history lines to save in the file, this could be a thousand or a billion, depending on your preference.</li><li><code>HISTSIZE</code>: maximum number of history lines to keep in memory, which is usually the same as <code>SAVEHIST</code>. This could also be larger than <code>SAVEHIST</code> but not the other way around, because you simply can&rsquo;t save more than you have.</li></ul><p>There&rsquo;s also <code>setopt extendedhistory</code> and <code>HISTTIMEFORMAT</code> to add timestamps for those records, but I don&rsquo;t find them very useful so I won&rsquo;t cover them here. You may try <code>history -E</code> to take a look.</p><p>I&rsquo;ve always been aware of this, but it reminded me again how little I know about the shell I&rsquo;m using. On the other hand, it actually makes sense that we don&rsquo;t need to bother with learning something until we do.</p><hr><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><ul><li><a href=https://www.soberkoder.com/better-zsh-history/>Better zsh history</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://iamgodot.com/posts/a-rational-upgrade-for-my-dotfiles/><span class=title>« Prev</span><br><span>A Rational Upgrade for My Dotfiles</span>
</a><a class=next href=https://iamgodot.com/posts/git-directory-capitalization/><span class=title>Next »</span><br><span>Change the Capitalization of a Direcotry with Git</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=iamgodot/godot-blog-comments data-repo-id="MDEwOlJlcG9zaXRvcnkzOTk0Nzk0MTY=" data-category=Announcements data-category-id=DIC_kwDOF8-SeM4CO3OX data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=dark_dimmed data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2020-2024 <a href=https://iamgodot.com/>Godot's Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>