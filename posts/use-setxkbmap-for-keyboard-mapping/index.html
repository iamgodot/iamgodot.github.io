<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Use setxkbmap for Keyboard Mapping | Godot's Blog</title><meta name=keywords content="linux"><meta name=description content="这是一篇使用（过） Linux Xorg without any DE 以及笔记本外接键盘的人才能理解其中辛酸苦痛的抒情科普文。
TL;DR 外接键盘不要开蓝牙，直接插线，除非你乐意折腾 使用 setxkbmap 而不是 xmodmap 来做 key remapping 不要用 Xorg The Irrational Part 上午十点零一分，端坐到显示器前，深呼吸两次。
Ok，回滚内核版本之后 Screen Lock 卡死的问题果然消失了，我们继续。
进入系统，先看一下昨晚的日志吧：
... 需求目标： 1. 交换 L-Ctrl & Caps-Lock 2. 交换 Win & Alt 当前方案： 使用 xmodmap 自定义配置文件，在 startx 时执行 已知问题： 1. 系统挂起或蓝牙睡眠导致的 keyboard reconnection 会 reset 掉 Win&Alt 的交换 2. 之后重新执行 xmodmap 会导致 L-Ctrl&Caps-Lock 交换回原状，必须执行两次 后续跟进： 1. TTY console switch 快捷键不可用 2. Terminate X 快捷键 CAB(Ctrl-Alt-Backspace) 不可用 3."><meta name=author content><link rel=canonical href=https://iamgodot.com/posts/use-setxkbmap-for-keyboard-mapping/><link crossorigin=anonymous href=/assets/css/stylesheet.min.7cb1aaa4414c482febc7034a427761d087a2cf358f1be8f7beba5afc947b57d0.css integrity="sha256-fLGqpEFMSC/rxwNKQndh0IeizzWPG+j3vrpa/JR7V9A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://iamgodot.com/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://iamgodot.com/icons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://iamgodot.com/icons/favicon-32x32.png><link rel=apple-touch-icon href=https://iamgodot.com/icons/apple-touch-icon.png><link rel=mask-icon href=https://iamgodot.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Source+Code+Pro:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Source+Code+Pro:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=preconnect href=https://plausible.iamgodot.com><script defer data-domain=iamgodot.com src=https://plausible.iamgodot.com/js/plausible.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script><script></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-157042624-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Use setxkbmap for Keyboard Mapping"><meta property="og:description" content="这是一篇使用（过） Linux Xorg without any DE 以及笔记本外接键盘的人才能理解其中辛酸苦痛的抒情科普文。
TL;DR 外接键盘不要开蓝牙，直接插线，除非你乐意折腾 使用 setxkbmap 而不是 xmodmap 来做 key remapping 不要用 Xorg The Irrational Part 上午十点零一分，端坐到显示器前，深呼吸两次。
Ok，回滚内核版本之后 Screen Lock 卡死的问题果然消失了，我们继续。
进入系统，先看一下昨晚的日志吧：
... 需求目标： 1. 交换 L-Ctrl & Caps-Lock 2. 交换 Win & Alt 当前方案： 使用 xmodmap 自定义配置文件，在 startx 时执行 已知问题： 1. 系统挂起或蓝牙睡眠导致的 keyboard reconnection 会 reset 掉 Win&Alt 的交换 2. 之后重新执行 xmodmap 会导致 L-Ctrl&Caps-Lock 交换回原状，必须执行两次 后续跟进： 1. TTY console switch 快捷键不可用 2. Terminate X 快捷键 CAB(Ctrl-Alt-Backspace) 不可用 3."><meta property="og:type" content="article"><meta property="og:url" content="https://iamgodot.com/posts/use-setxkbmap-for-keyboard-mapping/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-16T04:57:10+08:00"><meta property="article:modified_time" content="2021-10-16T04:57:10+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Use setxkbmap for Keyboard Mapping"><meta name=twitter:description content="这是一篇使用（过） Linux Xorg without any DE 以及笔记本外接键盘的人才能理解其中辛酸苦痛的抒情科普文。
TL;DR 外接键盘不要开蓝牙，直接插线，除非你乐意折腾 使用 setxkbmap 而不是 xmodmap 来做 key remapping 不要用 Xorg The Irrational Part 上午十点零一分，端坐到显示器前，深呼吸两次。
Ok，回滚内核版本之后 Screen Lock 卡死的问题果然消失了，我们继续。
进入系统，先看一下昨晚的日志吧：
... 需求目标： 1. 交换 L-Ctrl & Caps-Lock 2. 交换 Win & Alt 当前方案： 使用 xmodmap 自定义配置文件，在 startx 时执行 已知问题： 1. 系统挂起或蓝牙睡眠导致的 keyboard reconnection 会 reset 掉 Win&Alt 的交换 2. 之后重新执行 xmodmap 会导致 L-Ctrl&Caps-Lock 交换回原状，必须执行两次 后续跟进： 1. TTY console switch 快捷键不可用 2. Terminate X 快捷键 CAB(Ctrl-Alt-Backspace) 不可用 3."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://iamgodot.com/posts/"},{"@type":"ListItem","position":3,"name":"Use setxkbmap for Keyboard Mapping","item":"https://iamgodot.com/posts/use-setxkbmap-for-keyboard-mapping/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Use setxkbmap for Keyboard Mapping","name":"Use setxkbmap for Keyboard Mapping","description":"这是一篇使用（过） Linux Xorg without any DE 以及笔记本外接键盘的人才能理解其中辛酸苦痛的抒情科普文。\nTL;DR 外接键盘不要开蓝牙，直接插线，除非你乐意折腾 使用 setxkbmap 而不是 xmodmap 来做 key remapping 不要用 Xorg The Irrational Part 上午十点零一分，端坐到显示器前，深呼吸两次。\nOk，回滚内核版本之后 Screen Lock 卡死的问题果然消失了，我们继续。\n进入系统，先看一下昨晚的日志吧：\n... 需求目标： 1. 交换 L-Ctrl \u0026amp; Caps-Lock 2. 交换 Win \u0026amp; Alt 当前方案： 使用 xmodmap 自定义配置文件，在 startx 时执行 已知问题： 1. 系统挂起或蓝牙睡眠导致的 keyboard reconnection 会 reset 掉 Win\u0026amp;Alt 的交换 2. 之后重新执行 xmodmap 会导致 L-Ctrl\u0026amp;Caps-Lock 交换回原状，必须执行两次 后续跟进： 1. TTY console switch 快捷键不可用 2. Terminate X 快捷键 CAB(Ctrl-Alt-Backspace) 不可用 3.","keywords":["linux"],"articleBody":"这是一篇使用（过） Linux Xorg without any DE 以及笔记本外接键盘的人才能理解其中辛酸苦痛的抒情科普文。\nTL;DR 外接键盘不要开蓝牙，直接插线，除非你乐意折腾 使用 setxkbmap 而不是 xmodmap 来做 key remapping 不要用 Xorg The Irrational Part 上午十点零一分，端坐到显示器前，深呼吸两次。\nOk，回滚内核版本之后 Screen Lock 卡死的问题果然消失了，我们继续。\n进入系统，先看一下昨晚的日志吧：\n... 需求目标： 1. 交换 L-Ctrl \u0026 Caps-Lock 2. 交换 Win \u0026 Alt 当前方案： 使用 xmodmap 自定义配置文件，在 startx 时执行 已知问题： 1. 系统挂起或蓝牙睡眠导致的 keyboard reconnection 会 reset 掉 Win\u0026Alt 的交换 2. 之后重新执行 xmodmap 会导致 L-Ctrl\u0026Caps-Lock 交换回原状，必须执行两次 后续跟进： 1. TTY console switch 快捷键不可用 2. Terminate X 快捷键 CAB(Ctrl-Alt-Backspace) 不可用 3. Keyboard backlight ... 唔，大概记起来了，昨晚改用了 setxkbmap 之后应该可以解决重连的问题了，不过奇怪的是 ctrl:swapcaps 的 option 一直没有生效，折腾到半夜也没好..\n难道是有什么地方又去执行 xmodmap 了？奇怪，在 .xinitrc 里面已经把判断代码注释掉了呀，不管了，删除 ~/.Xmodmap 再说，反正是个软链接。\n哈，居然成功了！看来就是这个原因，估计这也是已知问题 1 的根源，xmodmap 的设置被 setxkbmap 重置了，果然直接用后者是明智的。\n不过可惜之前查了半天才解决的 .xinitrc 里面 xmodmap 执行顺序问题了：\n... if [ -f $HOME/.Xmodmap ]; then (sleep 1; xmodmap $HOME/.Xmodmap) \u0026 fi exec i3 ... 虽然多花了 1s 的开机时间，但毕竟规避掉了 xmodmap 设置被 wm 莫名其妙 reset 的难点，不过现在也不需要了，唔，白搞了半天..\nSetxkbmap 的 rule setting 就是好，这下插拔外接键盘 USB 也不会 reset 改键映射了。不过如果用蓝牙的话好像还不够，至少得配置 udev rule 开启蓝牙键盘唤醒再 run 个 remapping 的脚本才好，如此剩下就是背光了…\n咦，好像又过去两个小时了？\n…\n站起来，默默找出键盘连接线，插好，保存唯一的 setxkbmap 配置，重启。\n进入系统，改键映射正常，拔开 USB，重插，一切正常。唔，背光真好看。\n看下时间，五分钟。唔，终于清静了。\nThe Rational Part Keyboard mapping 用惯 Vim 的人可能都会有改键的需求，L-Ctrl \u003c-\u003e Caps-Lock 或者 Escape \u003c-\u003e Caps-Lock 等等。\n另外 Mac 上面的 Option | Command 对应到 Windows 键盘是 Win | Alt, 我的习惯是把 Alt 当 Option 用，所以要换到左边去。\nAbout keyboard 键盘的原理大概是每个按键都有对应的（十六进制）scancode，在内核层 scancode 会被映射会 keycode，而在 X 中（比如 xmodmap）会进一步把 keycode 对应到不同的 keysym，比如 keycode 38 = a A 就代表 keycode 为 38 的键会输出字母 a，如果配合 Shift 键则输入 A.\n而 xmodmap 改键的原理也是通过修改 keycode 的对应关系来实现的，只是在配置文件中还可以使用更方便的命令比如 clear/remove/add 来描述。\n另外 xmodmap 还支持通过修改 pointer 参数来支持触摸屏滚动的方向，比如像 Mac 一样，手指上滑让页面下翻。\n但是 xmodmap 只适合做比较简单的自定义，毕竟写起来复杂，还容易被 setxkbmap 覆盖。\nUse setxkbmap setxkbmap 使用起来很简单，如果实现我自己的需求，想要开机生效的话，直接在 .xinitrc 中加入一行命令即可：\nsetxkbmap -option ctrl:swapcaps,altwin:swap_lalt_lwin 如果支持插拔的话，则要给 Xorg 增加配置文件（如 /etc/X11/xorg.conf.d/00-keyboard.conf）：\nSection \"ServerFlags\" Option \"DontZap\" \"False\" EndSection Section \"InputClass\" Identifier \"system-keyboard\" MatchIsKeyboard \"on\" Option \"XkbOptions\" \"ctrl:swapcaps,altwin:swap_lalt_lwin,terminate:ctrl_alt_bksp\" EndSection CAB 那么上面配置文件里面的 ServerFlags 和 option 中的 terminate:ctrl_alt_bksp 是做什么的？\n就是来支持 CAB(Ctrl-Alt-Backspace) 快捷键关闭当前 X 程序的。这很有用，尤其是在 X window 卡死没有响应的时候。\n当然 Ctrl-Alt-Fx 切换 tty 或者强制关机也没什么不可以的\nWM 也好，XDG 的那些 DE 也好（GNOME/KDE/…），X 战警们的难题永无止境，然而时间有限，不得不做取舍的我只好以此纪念无辜逝去的时间以及无数个奋战到深夜的自己。\nReferences\nXmodmap - Archwiki Xorg keyboard configuration - Archwiki Understand how keyboards work ","wordCount":"297","inLanguage":"en","datePublished":"2021-10-16T04:57:10+08:00","dateModified":"2021-10-16T04:57:10+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://iamgodot.com/posts/use-setxkbmap-for-keyboard-mapping/"},"publisher":{"@type":"Organization","name":"Godot's Blog","logo":{"@type":"ImageObject","url":"https://iamgodot.com/icons/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://iamgodot.com accesskey=h title="Godot's Blog (Alt + H)">Godot's Blog</a>
<span class=logo-switches></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Use setxkbmap for Keyboard Mapping</h1><div class=post-meta><span title='2021-10-16 04:57:10 +0800 +0800'>10-16</span>&nbsp;·&nbsp;2 min</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#tldr aria-label=TL;DR>TL;DR</a></li><li><a href=#the-irrational-part aria-label="The Irrational Part">The Irrational Part</a></li><li><a href=#the-rational-part aria-label="The Rational Part">The Rational Part</a><ul><li><a href=#keyboard-mapping aria-label="Keyboard mapping">Keyboard mapping</a></li><li><a href=#about-keyboard aria-label="About keyboard">About keyboard</a></li><li><a href=#use-setxkbmap aria-label="Use setxkbmap">Use setxkbmap</a></li><li><a href=#cab aria-label=CAB>CAB</a></li></ul></li></ul></div></details></div><div class=post-content><p>这是一篇使用（过） Linux Xorg without any DE 以及笔记本外接键盘的人才能理解其中辛酸苦痛的抒情科普文。</p><h1 id=tldr>TL;DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h1><ol><li>外接键盘不要开蓝牙，直接插线，除非你乐意折腾</li><li>使用 setxkbmap 而不是 xmodmap 来做 key remapping</li><li>不要用 Xorg</li></ol><h1 id=the-irrational-part>The Irrational Part<a hidden class=anchor aria-hidden=true href=#the-irrational-part>#</a></h1><p>上午十点零一分，端坐到显示器前，深呼吸两次。</p><p>Ok，回滚内核版本之后 Screen Lock 卡死的问题果然消失了，我们继续。</p><p>进入系统，先看一下昨晚的日志吧：</p><pre tabindex=0><code>...
需求目标：

1. 交换 L-Ctrl &amp; Caps-Lock
2. 交换 Win &amp; Alt

当前方案：

使用 xmodmap 自定义配置文件，在 startx 时执行

已知问题：

1. 系统挂起或蓝牙睡眠导致的 keyboard reconnection 会 reset 掉 Win&amp;Alt 的交换
2. 之后重新执行 xmodmap 会导致 L-Ctrl&amp;Caps-Lock 交换回原状，必须执行两次

后续跟进：
1. TTY console switch 快捷键不可用
2. Terminate X 快捷键 CAB(Ctrl-Alt-Backspace) 不可用
3. Keyboard backlight
...
</code></pre><p>唔，大概记起来了，昨晚改用了 setxkbmap 之后应该可以解决重连的问题了，不过奇怪的是 ctrl:swapcaps 的 option 一直没有生效，折腾到半夜也没好..</p><p>难道是有什么地方又去执行 xmodmap 了？奇怪，在 .xinitrc 里面已经把判断代码注释掉了呀，不管了，删除 ~/.Xmodmap 再说，反正是个软链接。</p><p>哈，居然成功了！看来就是这个原因，估计这也是已知问题 1 的根源，xmodmap 的设置被 setxkbmap 重置了，果然直接用后者是明智的。</p><p>不过可惜之前查了半天才解决的 .xinitrc 里面 xmodmap 执行顺序问题了：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f $HOME/.Xmodmap <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>sleep 1; xmodmap $HOME/.Xmodmap<span style=color:#f92672>)</span> &amp;
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exec i3
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>虽然多花了 1s 的开机时间，但毕竟规避掉了 xmodmap 设置被 wm 莫名其妙 reset 的难点，不过现在也不需要了，唔，白搞了半天..</p><p>Setxkbmap 的 rule setting 就是好，这下插拔外接键盘 USB 也不会 reset 改键映射了。不过如果用蓝牙的话好像还不够，至少得配置 udev rule 开启蓝牙键盘唤醒再 run 个 remapping 的脚本才好，如此剩下就是背光了&mldr;</p><p>咦，好像又过去两个小时了？</p><p>&mldr;</p><p>站起来，默默找出键盘连接线，插好，保存唯一的 setxkbmap 配置，重启。</p><p>进入系统，改键映射正常，拔开 USB，重插，一切正常。唔，背光真好看。</p><p>看下时间，五分钟。唔，终于清静了。</p><h1 id=the-rational-part>The Rational Part<a hidden class=anchor aria-hidden=true href=#the-rational-part>#</a></h1><h2 id=keyboard-mapping>Keyboard mapping<a hidden class=anchor aria-hidden=true href=#keyboard-mapping>#</a></h2><p>用惯 Vim 的人可能都会有改键的需求，L-Ctrl &lt;-> Caps-Lock 或者 Escape &lt;-> Caps-Lock 等等。</p><p>另外 Mac 上面的 Option | Command 对应到 Windows 键盘是 Win | Alt, 我的习惯是把 Alt 当 Option 用，所以要换到左边去。</p><h2 id=about-keyboard>About keyboard<a hidden class=anchor aria-hidden=true href=#about-keyboard>#</a></h2><p>键盘的原理大概是每个按键都有对应的（十六进制）scancode，在内核层 scancode 会被映射会 keycode，而在 X 中（比如 xmodmap）会进一步把 keycode 对应到不同的 keysym，比如 <code>keycode 38 = a A</code> 就代表 keycode 为 38 的键会输出字母 a，如果配合 Shift 键则输入 A.</p><p>而 xmodmap 改键的原理也是通过修改 keycode 的对应关系来实现的，只是在配置文件中还可以使用更方便的命令比如 clear/remove/add 来描述。</p><p>另外 xmodmap 还支持通过修改 pointer 参数来支持触摸屏滚动的方向，比如像 Mac 一样，手指上滑让页面下翻。</p><p>但是 xmodmap 只适合做比较简单的自定义，毕竟写起来复杂，还容易被 setxkbmap 覆盖。</p><h2 id=use-setxkbmap>Use setxkbmap<a hidden class=anchor aria-hidden=true href=#use-setxkbmap>#</a></h2><p>setxkbmap 使用起来很简单，如果实现我自己的需求，想要开机生效的话，直接在 .xinitrc 中加入一行命令即可：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>setxkbmap -option ctrl:swapcaps,altwin:swap_lalt_lwin
</span></span></code></pre></div><p>如果支持插拔的话，则要给 Xorg 增加配置文件（如 /etc/X11/xorg.conf.d/00-keyboard.conf）：</p><pre tabindex=0><code>Section &#34;ServerFlags&#34;
	Option &#34;DontZap&#34; &#34;False&#34;
EndSection

Section &#34;InputClass&#34;
        Identifier &#34;system-keyboard&#34;
        MatchIsKeyboard &#34;on&#34;
        Option &#34;XkbOptions&#34; &#34;ctrl:swapcaps,altwin:swap_lalt_lwin,terminate:ctrl_alt_bksp&#34;
EndSection
</code></pre><h2 id=cab>CAB<a hidden class=anchor aria-hidden=true href=#cab>#</a></h2><p>那么上面配置文件里面的 ServerFlags 和 option 中的 terminate:ctrl_alt_bksp 是做什么的？</p><p>就是来支持 CAB(Ctrl-Alt-Backspace) 快捷键关闭当前 X 程序的。这很有用，尤其是在 X window 卡死没有响应的时候。</p><p>当然 Ctrl-Alt-Fx 切换 tty 或者强制关机也没什么不可以的</p><hr><p>WM 也好，XDG 的那些 DE 也好（GNOME/KDE/&mldr;），X 战警们的难题永无止境，然而时间有限，不得不做取舍的我只好以此纪念无辜逝去的时间以及无数个奋战到深夜的自己。</p><hr><p><em>References</em></p><ul><li><a href=https://wiki.archlinux.org/title/Xmodmap>Xmodmap - Archwiki</a></li><li><a href=https://wiki.archlinux.org/title/Xorg/Keyboard_configuration>Xorg keyboard configuration - Archwiki</a></li><li><a href=http://www.linuxintro.org/wiki/Understand_how_keyboards_work>Understand how keyboards work</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://iamgodot.com/tags/linux/>linux</a></li></ul><nav class=paginav><a class=prev href=https://iamgodot.com/posts/simple-recursion/><span class=title>« Prev Page</span><br><span>(Re)Write recursions easily</span></a>
<a class=next href=https://iamgodot.com/posts/if-by-life-you-were-deceived/><span class=title>Next Page »</span><br><span>假如生活欺骗了你</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=iamgodot/godot-blog-comments data-repo-id="MDEwOlJlcG9zaXRvcnkzOTk0Nzk0MTY=" data-category=Announcements data-category-id=DIC_kwDOF8-SeM4CO3OX data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=dark_dimmed data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2020-2022 <a href=https://iamgodot.com>Godot's Blog</a></span>
<span>| <a href=http://beian.miit.gov.cn/ target=_blank>京ICP备20005558号-2</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>