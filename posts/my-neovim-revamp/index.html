<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>My Neovim Revamp | Godot's Blog</title><meta name=keywords content="neovim,neovim plugins,neovim from scratch"><meta name=description content="Yeah, I did it again, but for a good reason.
I have been using VSCode for while, which is great with plugins like GitLens and Docker. Besides, it&rsquo;s really handy to debug code, view all kinds of files and draw various diagrams such as UML. I thought I&rsquo;d wave my hands to Neovim, however, I found I still need it, a lot.
Not trying to nitpick, but I have to switch between keyboard and mouse from time to time with VSCode, which sometimes can really interrupt my train of thoughts."><meta name=author content><link rel=canonical href=https://iamgodot.com/posts/my-neovim-revamp/><link crossorigin=anonymous href=/assets/css/stylesheet.min.7cb1aaa4414c482febc7034a427761d087a2cf358f1be8f7beba5afc947b57d0.css integrity="sha256-fLGqpEFMSC/rxwNKQndh0IeizzWPG+j3vrpa/JR7V9A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://iamgodot.com/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://iamgodot.com/icons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://iamgodot.com/icons/favicon-32x32.png><link rel=apple-touch-icon href=https://iamgodot.com/icons/apple-touch-icon.png><link rel=mask-icon href=https://iamgodot.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Source+Code+Pro:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Source+Code+Pro:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=preconnect href=https://plausible.iamgodot.com><script defer data-domain=iamgodot.com src=https://plausible.iamgodot.com/js/plausible.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script><script></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-157042624-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="My Neovim Revamp"><meta property="og:description" content="Yeah, I did it again, but for a good reason.
I have been using VSCode for while, which is great with plugins like GitLens and Docker. Besides, it&rsquo;s really handy to debug code, view all kinds of files and draw various diagrams such as UML. I thought I&rsquo;d wave my hands to Neovim, however, I found I still need it, a lot.
Not trying to nitpick, but I have to switch between keyboard and mouse from time to time with VSCode, which sometimes can really interrupt my train of thoughts."><meta property="og:type" content="article"><meta property="og:url" content="https://iamgodot.com/posts/my-neovim-revamp/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-05T20:31:52+08:00"><meta property="article:modified_time" content="2023-04-05T20:31:52+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="My Neovim Revamp"><meta name=twitter:description content="Yeah, I did it again, but for a good reason.
I have been using VSCode for while, which is great with plugins like GitLens and Docker. Besides, it&rsquo;s really handy to debug code, view all kinds of files and draw various diagrams such as UML. I thought I&rsquo;d wave my hands to Neovim, however, I found I still need it, a lot.
Not trying to nitpick, but I have to switch between keyboard and mouse from time to time with VSCode, which sometimes can really interrupt my train of thoughts."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://iamgodot.com/posts/"},{"@type":"ListItem","position":3,"name":"My Neovim Revamp","item":"https://iamgodot.com/posts/my-neovim-revamp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"My Neovim Revamp","name":"My Neovim Revamp","description":"Yeah, I did it again, but for a good reason.\nI have been using VSCode for while, which is great with plugins like GitLens and Docker. Besides, it\u0026rsquo;s really handy to debug code, view all kinds of files and draw various diagrams such as UML. I thought I\u0026rsquo;d wave my hands to Neovim, however, I found I still need it, a lot.\nNot trying to nitpick, but I have to switch between keyboard and mouse from time to time with VSCode, which sometimes can really interrupt my train of thoughts.","keywords":["neovim","neovim plugins","neovim from scratch"],"articleBody":"Yeah, I did it again, but for a good reason.\nI have been using VSCode for while, which is great with plugins like GitLens and Docker. Besides, it’s really handy to debug code, view all kinds of files and draw various diagrams such as UML. I thought I’d wave my hands to Neovim, however, I found I still need it, a lot.\nNot trying to nitpick, but I have to switch between keyboard and mouse from time to time with VSCode, which sometimes can really interrupt my train of thoughts. In addition, it doesn’t feel effortless to use terminal as when I’m in a Tmux session.\nFor whatever it’s worth, I spent some hours on picking Neovim back and upgrading everything. Now it feels unprecedently smooth and efficient, and I’d like to share how I revamped my configs.\nTry it out First and most important of all, a showcase:\nOf course, you will need Neovim + Git + Lua installed. It’s better to have black + isort + ruff executables since I use them for Python linting and formatting.\nThen replace your ~/.config/nvim with my nvim folder and open with nvim to see how everything goes.\nIf it works as expected, lazy.nvim is going to take over and install everything shortly, then you’re all set.\nIn case things go south, please leave a comment and let me know. Now if you’re still interested, read along and I’ll explain as much I can.\nWhy Neovim So I ask myself, why don’t I just use Vim? Let’s see how Neovim states for itself:\nI notice documented API\u0026compatible with Vim, and I’m interested in that builtin terminal emulator, but what really got me is the Lua support for config and plugins. To me, it feels lighter and simpler to use and learn, after all, it’s a real programming language. From the Lua guide it provides, we can easily pick up:\nNeovim supports a init.lua config file with which you can replace init.vim. Lua uses require() to load other modules, so you can do require(foo.bar). foo.bar or foo/bar means a sub-module bar under module foo. My configs Here is my structure of my config files:\nTo simply put it, the init.lua loads lazy.lua, which utilizes lazy.nvim, a plugin manager to install and setup every other plugin inside plugins. Besides, it will also import from config to configure Vim options and keymaps.\nMy plugins It takes a proper combination of plugins to have excellent experiences with Neovim, which is also the best part to enjoy while setting up.\nPlugin manager I’ve used vim-plug for a very long time while now the popular one is lazy.nvim. So I jumped right into it.\nIt provides a nice UI where you can manage all the packages, and I like how everything gets explained thoroughly in its documents, which is very friendly for starters, even those who are not.\nIn fact there’s even a full-fledged setup repo based on this plugin manager, called LazyVim , so that you can build your own on top of it.\nFuzzy finder Besides coding, we’re always searching stuff, therefore a powerful fuzzy finder is vital. There were ctrlp and fzf, and now it is telescope.\nIt has pickers, sorters and previewers. So you can find files, do live grep, and search through nearly everything such as help documents, git commits and command history. Just imagine away.\nBTW, this could become a test for your keymap design skill. Personally I tried my best to make use of all the leader key combinations.\nLSP support This outght to be the most complex part, so I’ll try to make the best sense of it and explain logically.\nFirst thing to know is LSP requires both client and server, in order to provide code functions like auto-completion. Neovim already has builtin LSP client so we just need to install servers(for our languages) and configure properly.\nTherefore we introduce mason, which plays a role of language server installer. Just type :Mason and install accordingly. This is convenient since we no longer have to prepare executables ourselves, e.g. pip install --user black. Pure installation won’t suffice, sometimes we need a bit more integration.\nFor LSP configuration, mason-lspconfig allows us to work easier with nvim-lspconfig. Let’s look at some setup code:\n... local servers = { pyright = {}, lua_ls = {}, } local capabilities = vim.lsp.protocol.make_client_capabilities() capabilities = require(\"cmp_nvim_lsp\").default_capabilities(capabilities) require(\"mason\").setup() local mason_lspconfig = require(\"mason-lspconfig\") mason_lspconfig.setup({ ensure_installed = vim.tbl_keys(servers), }) mason_lspconfig.setup_handlers({ function(server_name) require(\"lspconfig\")[server_name].setup({ capabilities = capabilities, on_attach = on_attach, settings = servers[server_name], }) end, }) Basically there’re two things. One is keep servers installed by ensure_installed, the other is setup handlers for them. I only add a default handler yet dedicated ones can be set for certain languages. Moreover, on_attach is usually for keymapping and capabilities comes in handy for broadcasting to server with additional functionality such as snippets, you can check from lspconfig document.\nFor linters and formatters, null-ls is a plugin which makes it every easy to setup these utilities. I setup classic black, isort as well as the new hot ruff, and for Lua I picked stylua, which seems just as opinionated as black.\nNow we have linting and formatting, and we can go to difinition etc. There’s only one missing piece left called completion. To achieve that we just need nvim-cmp along with some helpers. Personaly I use LuaSnip with friendly-snippets as its source, and nvim-path for file path completion.\nSo far we’ve got everything covered for code functions, in which each part can be further extended to support more languages and richer functionalities.\nMiscellaneous There’s no reason to stop here, because so many more await. I’ll list some of them here:\nnvim-tree: file explorer. vim-fugitive: git helper. nvim-autopairs: simple yet necessary. trouble: manage diagnostics in a better way. lightspeed: my favorite for faster movements. vim-airline + tmuxline: decorate status lines for both Neovim and Tmux. Last but not least, you deserve nice color schemes, here’s my recommendation:\ntokyonight: good and dark. catppuccin: pretty and elegant. neosolarized: classic forever. space-vim-dark: I used it all the time. rose-pine: Heard they’re for minimalist. At last In my mind, using Neovim is all about fast(well, maybe not themes), and once you make it your own, no one can ever steal that from you. I feel so safe with it.\nReferences\nMy dotfiles ","wordCount":"1053","inLanguage":"en","datePublished":"2023-04-05T20:31:52+08:00","dateModified":"2023-04-05T20:31:52+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://iamgodot.com/posts/my-neovim-revamp/"},"publisher":{"@type":"Organization","name":"Godot's Blog","logo":{"@type":"ImageObject","url":"https://iamgodot.com/icons/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://iamgodot.com accesskey=h title="Godot's Blog (Alt + H)">Godot's Blog</a>
<span class=logo-switches></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>My Neovim Revamp</h1><div class=post-meta><span title='2023-04-05 20:31:52 +0800 +0800'>04-05</span>&nbsp;·&nbsp;5 min</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#try-it-out aria-label="Try it out">Try it out</a></li><li><a href=#why-neovim aria-label="Why Neovim">Why Neovim</a></li><li><a href=#my-configs aria-label="My configs">My configs</a></li><li><a href=#my-plugins aria-label="My plugins">My plugins</a><ul><ul><li><a href=#plugin-manager aria-label="Plugin manager">Plugin manager</a></li><li><a href=#fuzzy-finder aria-label="Fuzzy finder">Fuzzy finder</a></li><li><a href=#lsp-support aria-label="LSP support">LSP support</a></li><li><a href=#miscellaneous aria-label=Miscellaneous>Miscellaneous</a></li></ul></ul></li><li><a href=#at-last aria-label="At last">At last</a></li></ul></div></details></div><div class=post-content><p>Yeah, I did it again, but for a good reason.</p><p>I have been using VSCode for while, which is great with plugins like <code>GitLens</code> and <code>Docker</code>. Besides, it&rsquo;s really handy to debug code, view all kinds of files and draw various diagrams such as UML. I thought I&rsquo;d wave my hands to Neovim, however, I found I still need it, a lot.</p><p>Not trying to nitpick, but I have to switch between keyboard and mouse from time to time with VSCode, which sometimes can really interrupt my train of thoughts. In addition, it doesn&rsquo;t feel effortless to use terminal as when I&rsquo;m in a Tmux session.</p><p>For whatever it&rsquo;s worth, I spent some hours on picking Neovim back and upgrading everything. Now it feels unprecedently smooth and efficient, and I&rsquo;d like to share how I revamped my configs.</p><h1 id=try-it-out>Try it out<a hidden class=anchor aria-hidden=true href=#try-it-out>#</a></h1><p>First and most important of all, a showcase:</p><p><img loading=lazy src=https://static.iamgodot.com/content/images/202304071349531.png alt></p><p>Of course, you will need <code>Neovim</code> + <code>Git</code> + <code>Lua</code> installed. It&rsquo;s better to have <code>black</code> + <code>isort</code> + <code>ruff</code> executables since I use them for Python linting and formatting.</p><p>Then replace your <code>~/.config/nvim</code> with my <a href=https://github.com/iamgodot/dotfiles/tree/master/nvim><code>nvim</code> folder</a> and open with <code>nvim</code> to see how everything goes.</p><p>If it works as expected, <code>lazy.nvim</code> is going to take over and install everything shortly, then you&rsquo;re all set.</p><p><img loading=lazy src=https://static.iamgodot.com/content/images/202304061355014.png alt></p><p>In case things go south, please leave a comment and let me know. Now if you&rsquo;re still interested, read along and I&rsquo;ll explain as much I can.</p><h1 id=why-neovim>Why Neovim<a hidden class=anchor aria-hidden=true href=#why-neovim>#</a></h1><p>So I ask myself, why don&rsquo;t I just use Vim? Let&rsquo;s see how Neovim states for itself:</p><p><img loading=lazy src=https://static.iamgodot.com/content/images/202304061324529.png alt></p><p>I notice documented API&amp;compatible with Vim, and I&rsquo;m interested in that builtin terminal emulator, but what really got me is the Lua support for config and plugins. To me, it feels lighter and simpler to use and learn, after all, it&rsquo;s a real programming language. From the <a href=https://neovim.io/doc/user/lua-guide.html>Lua guide</a> it provides, we can easily pick up:</p><ul><li>Neovim supports a <code>init.lua</code> config file with which you can replace <code>init.vim</code>.</li><li>Lua uses <code>require()</code> to load other modules, so you can do <code>require(foo.bar)</code>.</li><li><code>foo.bar</code> or <code>foo/bar</code> means a sub-module <code>bar</code> under module <code>foo</code>.</li></ul><h1 id=my-configs>My configs<a hidden class=anchor aria-hidden=true href=#my-configs>#</a></h1><p>Here is my structure of my config files:</p><p><img loading=lazy src=https://static.iamgodot.com/content/images/202304061307275.png alt></p><p>To simply put it, the <code>init.lua</code> loads <code>lazy.lua</code>, which utilizes <code>lazy.nvim</code>, a plugin manager to install and setup every other plugin inside <code>plugins</code>. Besides, it will also import from <code>config</code> to configure Vim options and keymaps.</p><h1 id=my-plugins>My plugins<a hidden class=anchor aria-hidden=true href=#my-plugins>#</a></h1><p>It takes a proper combination of plugins to have excellent experiences with Neovim, which is also the best part to enjoy while setting up.</p><h3 id=plugin-manager>Plugin manager<a hidden class=anchor aria-hidden=true href=#plugin-manager>#</a></h3><p>I&rsquo;ve used <code>vim-plug</code> for a very long time while now the popular one is <code>lazy.nvim</code>. So I jumped right into it.</p><p>It provides a nice UI where you can manage all the packages, and I like how everything gets explained thoroughly in its documents, which is very friendly for starters, even those who are not.</p><p>In fact there&rsquo;s even a full-fledged setup repo based on this plugin manager, called <code>LazyVim</code> , so that you can build your own on top of it.</p><h3 id=fuzzy-finder>Fuzzy finder<a hidden class=anchor aria-hidden=true href=#fuzzy-finder>#</a></h3><p>Besides coding, we&rsquo;re always searching stuff, therefore a powerful fuzzy finder is vital. There were <code>ctrlp</code> and <code>fzf</code>, and now it is <code>telescope</code>.</p><p>It has pickers, sorters and previewers. So you can find files, do live grep, and search through nearly everything such as help documents, git commits and command history. Just imagine away.</p><p>BTW, this could become a test for your keymap design skill. Personally I tried my best to make use of all the leader key combinations.</p><h3 id=lsp-support>LSP support<a hidden class=anchor aria-hidden=true href=#lsp-support>#</a></h3><p>This outght to be the most complex part, so I&rsquo;ll try to make the best sense of it and explain logically.</p><p>First thing to know is LSP requires both client and server, in order to provide code functions like auto-completion. Neovim already has builtin LSP client so we just need to install servers(for our languages) and configure properly.</p><p>Therefore we introduce <code>mason</code>, which plays a role of language server installer. Just type <code>:Mason</code> and install accordingly. This is convenient since we no longer have to prepare executables ourselves, e.g. <code>pip install --user black</code>. Pure installation won&rsquo;t suffice, sometimes we need a bit more integration.</p><p>For LSP configuration, <code>mason-lspconfig</code> allows us to work easier with <code>nvim-lspconfig</code>. Let&rsquo;s look at some setup code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>local</span> servers <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    pyright <span style=color:#f92672>=</span> {},
</span></span><span style=display:flex><span>    lua_ls <span style=color:#f92672>=</span> {},
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>local</span> capabilities <span style=color:#f92672>=</span> vim.lsp.protocol.make_client_capabilities()
</span></span><span style=display:flex><span>capabilities <span style=color:#f92672>=</span> require(<span style=color:#e6db74>&#34;cmp_nvim_lsp&#34;</span>).default_capabilities(capabilities)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>require(<span style=color:#e6db74>&#34;mason&#34;</span>).setup()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>local</span> mason_lspconfig <span style=color:#f92672>=</span> require(<span style=color:#e6db74>&#34;mason-lspconfig&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mason_lspconfig.setup({
</span></span><span style=display:flex><span>    ensure_installed <span style=color:#f92672>=</span> vim.tbl_keys(servers),
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mason_lspconfig.setup_handlers({
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span>(server_name)
</span></span><span style=display:flex><span>        require(<span style=color:#e6db74>&#34;lspconfig&#34;</span>)[server_name].setup({
</span></span><span style=display:flex><span>            capabilities <span style=color:#f92672>=</span> capabilities,
</span></span><span style=display:flex><span>            on_attach <span style=color:#f92672>=</span> on_attach,
</span></span><span style=display:flex><span>            settings <span style=color:#f92672>=</span> servers[server_name],
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>,
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>Basically there&rsquo;re two things. One is keep servers installed by <code>ensure_installed</code>, the other is setup handlers for them. I only add a default handler yet dedicated ones can be set for certain languages. Moreover, <code>on_attach</code> is usually for keymapping and <code>capabilities</code> comes in handy for broadcasting to server with additional functionality such as snippets, you can check from <code>lspconfig</code> document.</p><p>For linters and formatters, <code>null-ls</code> is a plugin which makes it every easy to setup these utilities. I setup classic <code>black</code>, <code>isort</code> as well as the new hot <code>ruff</code>, and for Lua I picked <code>stylua</code>, which seems just as opinionated as <code>black</code>.</p><p>Now we have linting and formatting, and we can go to difinition etc. There&rsquo;s only one missing piece left called completion. To achieve that we just need <code>nvim-cmp</code> along with some helpers. Personaly I use <code>LuaSnip</code> with <code>friendly-snippets</code> as its source, and <code>nvim-path</code> for file path completion.</p><p>So far we&rsquo;ve got everything covered for code functions, in which each part can be further extended to support more languages and richer functionalities.</p><h3 id=miscellaneous>Miscellaneous<a hidden class=anchor aria-hidden=true href=#miscellaneous>#</a></h3><p>There&rsquo;s no reason to stop here, because so many more await. I&rsquo;ll list some of them here:</p><ul><li><code>nvim-tree</code>: file explorer.</li><li><code>vim-fugitive</code>: git helper.</li><li><code>nvim-autopairs</code>: simple yet necessary.</li><li><code>trouble</code>: manage diagnostics in a better way.</li><li><code>lightspeed</code>: my favorite for faster movements.</li><li><code>vim-airline</code> + <code>tmuxline</code>: decorate status lines for both Neovim and Tmux.</li></ul><p>Last but not least, you deserve nice color schemes, here&rsquo;s my recommendation:</p><ul><li><code>tokyonight</code>: good and dark.</li><li><code>catppuccin</code>: pretty and elegant.</li><li><code>neosolarized</code>: classic forever.</li><li><code>space-vim-dark</code>: I used it all the time.</li><li><code>rose-pine</code>: Heard they&rsquo;re for minimalist.</li></ul><h1 id=at-last>At last<a hidden class=anchor aria-hidden=true href=#at-last>#</a></h1><p>In my mind, using Neovim is all about fast(well, maybe not themes), and once you make it your own, no one can ever steal that from you. I feel so safe with it.</p><hr><p><em>References</em></p><ul><li><a href=https://github.com/iamgodot/dotfiles>My dotfiles</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://iamgodot.com/tags/neovim/>neovim</a></li><li><a href=https://iamgodot.com/tags/neovim-plugins/>neovim plugins</a></li><li><a href=https://iamgodot.com/tags/neovim-from-scratch/>neovim from scratch</a></li></ul><nav class=paginav><a class=next href=https://iamgodot.com/posts/first-meditation-after-covid/><span class=title>Next Page »</span><br><span>感染，以及恢复后的第一次冥想</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=iamgodot/godot-blog-comments data-repo-id="MDEwOlJlcG9zaXRvcnkzOTk0Nzk0MTY=" data-category=Announcements data-category-id=DIC_kwDOF8-SeM4CO3OX data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=dark_dimmed data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2020-2023 <a href=https://iamgodot.com>Godot's Blog</a></span>
<span>| <a href=http://beian.miit.gov.cn/ target=_blank>京ICP备20005558号-2</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>